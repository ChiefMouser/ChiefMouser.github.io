

<!DOCTYPE html  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <head>
    <meta charset="utf-8">
    <title>shell常用cmd</title>
    
    <meta name="author" content="Yaccai">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- <link href="/css/blog.css" rel="stylesheet" type="text/css" media="all"> -->
    <link href="/css/syntax.css" rel="stylesheet" type="text/css" media="all">
    <link href="/css/bootstrap.2.2.2.min.css" rel="stylesheet" type="text/css" media="all">
    <link href="/css/style.css" rel="stylesheet" type="text/css" media="all">
    <link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css" media="all">
    
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/js/jquery.tocLight.js"></script>

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">yaccai</a>
          <ul class="nav">
            <li><a href="/explore.html">Explore / 浏览</a></li>
            <li><a href="/archive.html">Archive / 存档</a></li>
            <li><a href="/about.html">About / 关于</a></li>

<!--             <li><a href="https://github.com/yaccai">Github</a></li> -->
          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        

<div class="page-header">
  <h11>shell常用cmd </h11>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span> </span>
    </div>
    <div class="content">
      <div id="toc-container">
  <table class="toc" id="toc">
    <tbody>
      <tr>
        <td>
          <div id="toctitle">
            <h2>Contents</h2>
          </div>
          <ul>
            <li class="toc_level-1 toc_section-1">
              <a href="#tocAnchor-1-1"><span class="tocnumber">1</span> <span class="toctext">比较</span></a>
              <ul>
                <li class="toc_level-2 toc_section-2">
                  <a href="#tocAnchor-1-1-1"><span class="tocnumber">1.1</span> <span class="toctext">整数比较</span></a>
                </li>
                <li class="toc_level-2 toc_section-3">
                  <a href="#tocAnchor-1-1-2"><span class="tocnumber">1.2</span> <span class="toctext">字符串比较</span></a>
                </li>
                <li class="toc_level-2 toc_section-4">
                  <a href="#tocAnchor-1-1-3"><span class="tocnumber">1.3</span> <span class="toctext">文件测试</span></a>
                </li>
                <li class="toc_level-2 toc_section-5">
                  <a href="#tocAnchor-1-1-4"><span class="tocnumber">1.4</span> <span class="toctext">[] 差别 [[ ]]</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-6">
              <a href="#tocAnchor-1-6"><span class="tocnumber">2</span> <span class="toctext">单双引号</span></a>
            </li>
            <li class="toc_level-1 toc_section-7">
              <a href="#tocAnchor-1-7"><span class="tocnumber">3</span> <span class="toctext">分割文件名字</span></a>
            </li>
            <li class="toc_level-1 toc_section-8">
              <a href="#tocAnchor-1-8"><span class="tocnumber">4</span> <span class="toctext">两块网卡</span></a>
            </li>
            <li class="toc_level-1 toc_section-9">
              <a href="#tocAnchor-1-9"><span class="tocnumber">5</span> <span class="toctext">设置文件夹UI下隐藏</span></a>
            </li>
            <li class="toc_level-1 toc_section-10">
              <a href="#tocAnchor-1-10"><span class="tocnumber">6</span> <span class="toctext">crontab</span></a>
              <ul>
                <li class="toc_level-2 toc_section-11">
                  <a href="#tocAnchor-1-10-1"><span class="tocnumber">6.1</span> <span class="toctext">dd 备份</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-12">
              <a href="#tocAnchor-1-12"><span class="tocnumber">7</span> <span class="toctext">挂分区</span></a>
            </li>
            <li class="toc_level-1 toc_section-13">
              <a href="#tocAnchor-1-13"><span class="tocnumber">8</span> <span class="toctext">其他</span></a>
            </li>
            <li class="toc_level-1 toc_section-14">
              <a href="#tocAnchor-1-14"><span class="tocnumber">9</span> <span class="toctext">diskutil</span></a>
              <ul>
                <li class="toc_level-2 toc_section-15">
                  <a href="#tocAnchor-1-14-1"><span class="tocnumber">9.1</span> <span class="toctext">mergePartitions</span></a>
                </li>
                <li class="toc_level-2 toc_section-16">
                  <a href="#tocAnchor-1-14-2"><span class="tocnumber">9.2</span> <span class="toctext">partitionDisk</span></a>
                </li>
                <li class="toc_level-2 toc_section-17">
                  <a href="#tocAnchor-1-14-3"><span class="tocnumber">9.3</span> <span class="toctext">splitPartition</span></a>
                </li>
                <li class="toc_level-2 toc_section-18">
                  <a href="#tocAnchor-1-14-4"><span class="tocnumber">9.4</span> <span class="toctext">resizeVolume</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-19">
              <a href="#tocAnchor-1-19"><span class="tocnumber">10</span> <span class="toctext">hdiutil 映像操作</span></a>
              <ul>
                <li class="toc_level-2 toc_section-20">
                  <a href="#tocAnchor-1-19-1"><span class="tocnumber">10.1</span> <span class="toctext">修改大小</span></a>
                </li>
                <li class="toc_level-2 toc_section-21">
                  <a href="#tocAnchor-1-19-2"><span class="tocnumber">10.2</span> <span class="toctext">挂载 卸载</span></a>
                </li>
                <li class="toc_level-2 toc_section-22">
                  <a href="#tocAnchor-1-19-3"><span class="tocnumber">10.3</span> <span class="toctext">转换</span></a>
                </li>
              </ul>
            </li>
            <li class="toc_level-1 toc_section-23">
              <a href="#tocAnchor-1-23"><span class="tocnumber">11</span> <span class="toctext">端口占用</span></a>
            </li>
          </ul>
        </td>
      </tr>
    </tbody>
  </table>
</div><p>不是系统介绍，只列举几个常用的</p>

<!-- more -->

<h1 id="tocAnchor-1-1">比较</h1>

<h2 id="tocAnchor-1-1-1">整数比较</h2>

<table>
  <tbody>
    <tr>
      <td>-eq</td>
      <td>-ne</td>
      <td>-gt</td>
      <td>-lt</td>
      <td>-ge</td>
      <td>-le</td>
    </tr>
  </tbody>
</table>

<h2 id="tocAnchor-1-1-2">字符串比较</h2>

<table>
  <tbody>
    <tr>
      <td>==</td>
      <td>!=</td>
      <td>&lt;</td>
      <td>&lt;</td>
      <td>!或-z(空串检测)</td>
      <td>-n</td>
    </tr>
  </tbody>
</table>

<h2 id="tocAnchor-1-1-3">文件测试</h2>

<table>
  <tbody>
    <tr>
      <td>-e 存在</td>
      <td>-f 文件</td>
      <td>-d 目录</td>
      <td>-r 可读</td>
      <td>-w 可写</td>
      <td>-x 可执行</td>
    </tr>
  </tbody>
</table>

<p>单目检测 变量在右侧</p>

<h2 id="tocAnchor-1-1-4">[] 差别 [[ ]]</h2>

<ul>
  <li>数字： -eq -ne -lt -le -gt -ge，[[ ]]同 [ ]一致</li>
  <li>文件： -r、-l、-w、-x、-f、-d、-s、-nt、-ot，[[ ]]同 [ ]一致</li>
  <li>字符串： &gt; &lt; =(同==) != -n -z，不可使用“&lt;=”和“&gt;=”，[[ ]]同 [ ]一致，但在[]中，&gt;和&lt;- 必须使用\进行转义，即&gt;和&lt;</li>
  <li>逻辑： []为 -a -o ! [[ ]] 为&amp;&amp; || !</li>
  <li>数学运算： [] 不可以使用 [[ ]]可以使用+ - * / %</li>
  <li>组合： 均可用各自逻辑符号连接的数字（运算）测试、文件测试、字符测试</li>
</ul>

<p>[[ ]]更好用一些，主要区分不同测试类型时 比较符号</p>

<h1 id="tocAnchor-1-6">单双引号</h1>

<p>双引号中的$变量会发生替换，而单引号不会</p>

<h1 id="tocAnchor-1-7">分割文件名字</h1>
<p>file=”qwe.mp4”
echo “${file%.<em>}”        #文件名前部分
echo “${file#</em>.}”      #文件名扩展部分</p>

<p><br />
<br />
以上为部分语法
<br />
<br /></p>

<h1 id="tocAnchor-1-8">两块网卡</h1>
<p>两块网卡冲突 
en0为无线，192.168.2.0 可接互联网，en4为有线网链接一个小的局域网，192.168.1.0。 <br />
开机一小会儿可以同时正常工作，过一段时间，无法上网 netstat -nr 发现，en4所在网关变成了默认网关。
为什么会变不清楚，动态选择中有线网跳数少逐渐占优？ 解决办法：</p>

<ul>
  <li>sudo route delete default #奇怪路由表中有两个default，似乎只有一个有效</li>
  <li>sudo route add default 192.168.2.1</li>
  <li>sudo route add 192.168.1.0/8 192.168.1.1</li>
</ul>

<p>修改mac地址
sudo ifconfig en3 ether C8:3A:35:06:CC:00</p>

<h1 id="tocAnchor-1-9">设置文件夹UI下隐藏</h1>
<ul>
  <li>chflags hidden path</li>
  <li>chflags nohidden path</li>
</ul>

<h1 id="tocAnchor-1-10">crontab</h1>
<p>-e 进入编辑， -l 查看<br />
一条记录格式 :</p>

<div class="highlighter-rouge"><pre class="highlight"><code>? ? ? ? ?  command_to_execute  
│ │ │ │ │  
│ │ │ │ └─── day of week (0 - 6) (0 to 6 are Sunday to Saturday)  
│ │ │ └──────── month (1 - 12)  
│ │ └───────────── day of month (1 - 31)  
│ └────────────────── hour (0 - 23)  
└─────────────────────── min (0 - 59)  
如果每个单位（分钟，小时，天。。。）都要执行， 在对应位写 *  
如果想每个若干时间单位执行，对应的写 */3  
几个栗子：
43 21 * * * 每月周日的21:43 执行  
0,10 17 * * 0,2,3 每周日，周二，周三，的17:00和17:10执行  
0-10 17 1 * 0,2,3 其他不变，17点整到10分每分钟都执行一次  
* * */2 * * 每隔1天，另一天中每分钟执行   
2 8-20/3 * * *　8:02,11:02,14:02,17:02,20:02 执行  
</code></pre>
</div>

<p>注意，crontab命令执行时没有完整的PATH变量，需要在执行的sh中添加PATH：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>\#!/bin/sh  
PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin....  
\#PATH="/usr/local/bin/:$PATH"  
经查，只有/usr/bin:/bin两个目录  
... 1&gt;/dev/null 2&gt;/dev/null \#重定向到空设备文件  
</code></pre>
</div>

<p>邮件， 每执行一个任务就会发邮件，要消除在文件顶部加 MAILTO=””</p>

<h2 id="tocAnchor-1-10-1">dd 备份</h2>
<p>dd if=/dev/disk0s1 of=./efi.dmg
dd if=/dev/disk0 of=MBR.img bs=512 count=1</p>

<h1 id="tocAnchor-1-12">挂分区</h1>
<p>efi     sudo mount -t msdos /dev/disk0s1 /Volumes/efi 
windows sudo mount -t NTFS  /dev/disk0s4 /Volumes/Windows</p>

<h1 id="tocAnchor-1-13">其他</h1>

<ul>
  <li><a href="https://support.apple.com/zh-cn/HT201236">快捷键</a></li>
  <li><a href="https://github.com/sindresorhus/quick-look-plugins">quicklook</a></li>
  <li><a href="https://github.com/sindresorhus/awesome">程序推荐</a></li>
</ul>

<p>主文件加下面的文件名变成了英文 <br />
touch ~/downloads/.localized</p>

<h1 id="tocAnchor-1-14">diskutil</h1>
<ul>
  <li>DiskIdentifier &lt;–&gt; DI 看上去类似disk1s3</li>
  <li>DeviceNode     &lt;–&gt; DN 看上去是/dev/disk1s3</li>
  <li>
    <p>MountPoint     &lt;–&gt; MP 类似于 /Volumes/My_Partition</p>
  </li>
  <li>format         &lt;–&gt; FS  可用diskutil listFilesystems查看</li>
  <li>T              &lt;–&gt; part1Format part1Name part1Size 即格式 名称 大小</li>
  <li>分区大小指定方法:
    <ul>
      <li>浮点数后跟B,K(10^3)),M(10^6)),G(10^9),T(10^12),P(10^15),E(10^18)等(单位是字节Byte)，用来表述xxMB/GB/TB的空间大小</li>
      <li>浮点数后跟S(512字节区块),Ki(2^10)),Mi(2^20)),Gi(2^30),Ti(2^40),Pi(2^50),Ei(2^60)等(单位是字节Byte)，用来表述xxMB/GB/TB的空间大小</li>
      <li>浮点数后跟%，用来表述占用磁盘空间的百分比</li>
      <li>R，是说所有剩余空间。最好放在最后一个</li>
    </ul>
  </li>
</ul>

<h2 id="tocAnchor-1-14-1">mergePartitions</h2>
<p>合并两个分区<br />
diskutil mergePartitions [force] FS name DI1|DN1 dI2|DN2</p>

<ul>
  <li>例如 diskutil mergePartitions JHFS+ NewName disk3s4 disk3s7</li>
  <li>第一个分区应该是磁盘中靠前的分区vol，第二个分区必须紧跟第一个分区</li>
  <li>如果第一个分区不是JHFS+，就需要指定force</li>
  <li>没有force项，则第二个分区给格式化，数据丢失。如果有force，两分区都格式化丢失数据</li>
</ul>

<h2 id="tocAnchor-1-14-2">partitionDisk</h2>
<p>diskutil partitionDisk MP|DI|DN [numberOfPartitions] [APM|MBR|GPT] [T1 T2 T3…]</p>

<ul>
  <li>MP|DI|DN 被分区的磁盘</li>
  <li>numberOfPartitions 分区个数</li>
  <li>APM|MBR|GPT 磁盘分区方案</li>
  <li>后面是对应每个分区的三元组</li>
  <li>最后一个分区可以不用指定大小，会自动到达到磁盘结尾</li>
  <li>diskutil partitionDisk disk1 GPT exFAT VN1 25% free VN2 300Mi JHFS+ VN3 R</li>
  <li>diskutil partitionDisk disk1 MBR fat32 EFI 314.6M JHFS+ InstallOS R</li>
</ul>

<h2 id="tocAnchor-1-14-3">splitPartition</h2>
<p>所有数据都会丢失<br />
拆分一个分区为若干个<br />
diskutil splitPartition MP|DI|DN [numberOfPartitions] [T1 T2 T3…]</p>

<h2 id="tocAnchor-1-14-4">resizeVolume</h2>
<p>非破坏性的缩放分区大小，只支持JHFS+</p>

<ul>
  <li><em>缩小</em> diskutil resizeVolume MP|DI|DN size [T1 T2 T3…]
    <ul>
      <li>size是调整后的大小</li>
      <li>缩小分区，可以顺便对多出来的空间指定新分区，按照之前三元组的方式指定</li>
      <li>diskutil resizeVolume disk0s2 50G “MS-DOS FAT32” Public 20G</li>
      <li>diskutil resizeVolume disk1s3 0B</li>
    </ul>
  </li>
  <li><em>放大</em> diskutil resizeVolume MP|DI|DN size</li>
</ul>

<h1 id="tocAnchor-1-19">hdiutil 映像操作</h1>
<p>可以选用的 DMG 格式有</p>

<ul>
  <li>UDRO - 只读</li>
  <li>UDZO - 压缩</li>
  <li>UDSP - 稀疏</li>
  <li>UDRW - 读/写</li>
  <li>UDTO - DVD/CD 主映像</li>
</ul>

<p>hdiutil create <sizespec> <imagepath>
其他有用的可加上的参数</imagepath></sizespec></p>

<ul>
  <li>-fs制定文件系统</li>
  <li>-srcfolder <source folder=""></source> 从文件创建</li>
</ul>

<p>hdiutil create -size 100M -stdinpass -format UDZO -srcfolder code code.dmg
hdiutil create -size 1G -fs JHFS+ -volname ‘qvbdata’  qvbdata.dmg</p>

<h2 id="tocAnchor-1-19-1">修改大小</h2>
<p>hdiutil resize 150M /path/to/the/diskimage</p>

<h2 id="tocAnchor-1-19-2">挂载 卸载</h2>
<p>hdiutil attach archive_name.dmg
hdiutil eject /Volumes/archive_name/</p>

<h2 id="tocAnchor-1-19-3">转换</h2>
<p>hdiutil convert iso文件路径 -format UDRW -o 输出的dmg文件路径
hdiutil convert dmg文件路径 -format UDTO -o 输出的iso文件路径</p>

<h1 id="tocAnchor-1-23">端口占用</h1>

<p>lsof -i
netstat -an | grep 3306</p>

    </div>

    <hr>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="categories#CSE-ref">
    		CSE <span>8</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="tags#shell-ref">shell <span>2</span></a></li>
    
  



    </ul>
    


    <div class="pagination pagination-lg">
      
      <ul>
      
        <li class="prev"><a href="/posts/%E5%85%A5%E9%97%A8haskell" title="入门haskell">&larr; Previous（前一篇）</a></li>
      
        <li><a href="">Archive（目录）</a></li>
      
        <li class="next"><a href="/posts/%E5%81%9A%E6%A2%A6" title="做梦">Next（后一篇） &rarr;</a></li>
      
      </ul>
    </div>


<script type="text/javascript">
    $(document).ready(
        function expand() {
            var node = $("h1")
            for (var i = 0; i < node.length; i++) {
                var t = node[i]
                  var num = $("[href='#" + t.id + "']").children("span.tocnumber")
                  t.innerText = num.text() + "    " + t.innerText
            }

            node = $("h2")
            for (var i = 0; i < node.length; i++) {
                  var t = node[i]
                  var num = $("[href='#" + t.id + "']").children("span.tocnumber")
                  t.innerText = num.text() + "   " + t.innerText
            }

            
        }
    );
</script>
    
  </div>
</div>

      </div>
      <hr/>
      <center> <footer>
        &copy; 2016 Yaccai with help from <a href="http://jekyllrb.com" target="_blank" title="The simple, blog-aware, static site generator.">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" title="GitHub Pages">GitHub</a>.
        <br><br>
      </footer> </center>


    </div>


  </body>
</html>

